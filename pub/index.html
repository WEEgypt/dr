<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <title>Sales Report Generator</title>
        <link rel="icon" href="icon.png" />
        <link rel="apple-touch-icon" href="icon.png" />
        <link rel="stylesheet" href="style.css" />
        <link rel="manifest" href="manifest.json" />
        <script src="script.js"></script>
		<!-- Include Firebase SDK -->
		<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-messaging.js"></script>
		<script type="module">
			import { initializeApp } from 'firebase/app';
			import { getMessaging, getToken, onMessage } from 'firebase/messaging';
			import { requestPermission } from './firebase-messaging';

		</script>
    </head>
    <body>
        <div style="text-align: center;">
            <div style="display: inline-block; min-width: 300px; text-align: left;">
                <br />
                <br />
                <br />
                <div>
                    <h3>Sales Report Generator</h3>
                    <br />
                    <label style="width: max-content; font-size: 10px;">Generate sales report for ?</label>
                    <br />
                    <br />
                    <div>
                        <button style="width: 300px;" id="agent" onclick="goTo('agent.html')">Agent</button>
                        <br />
                        <br />
                        <button style="width: 300px;" id="store" onclick="goTo('store.html')">Store</button>
                        <br />
                        <br />
                        <button style="width: 300px;" id="area" onclick="goTo('area.html')">Area</button>
                    </div>
                </div>
            </div>
            <br />
            <br />
			<script>
			
function goTo(Link) {
    window.location.href = Link;
}
if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
        navigator.serviceWorker
            .register("service-worker.js")
            .then((registration) => {
                console.log("Service Worker registered with scope:", registration.scope);
            })
            .catch((err) => {
                console.log("Service Worker registration failed:", err);
            });
    });
} else {
    console.log("Service Workers are not supported in this browser.");
}
// firebase-messaging.js



const firebaseConfig = {
  apiKey: "AIzaSyBFvDaRTmGKNHl-NmVbDViGCZwgUoqUp-4",
  authDomain: "srg-noti.firebaseapp.com",
  projectId: "srg-noti",
  storageBucket: "srg-noti.appspot.com",
  messagingSenderId: "343977794136",
  appId: "1:343977794136:web:762692ac46784a5ea7082d",
  measurementId: "G-LH3VQERVS3"
};

// Initialize Firebase app
const app = initializeApp(firebaseConfig);
const messaging = getMessaging(app);

// Request permission to receive notifications
export const requestPermission = async () => {
  try {
    const status = await Notification.requestPermission();
    if (status === 'granted') {
      console.log('Notification permission granted.');
      const token = await getToken(messaging, { vapidKey: 'BHA063BRol-X9lEr8eq9CEnpvqZtkGqz2MjfwDDQxGV11EJGGYQVSNc0B14GCV1YHTIjja9gmWMBB6dnH5MFfa0' });
      console.log('FCM Token:', token);
      return token;
    } else {
      console.log('Unable to get permission to notify.');
    }
  } catch (err) {
    console.error('Error getting permission', err);
  }
};

// Listen for incoming messages
onMessage(messaging, (payload) => {
  console.log('Message received. ', payload);
  // Customize notification handling
});
// main.js


document.getElementById('enable-notifications').addEventListener('click', async () => {
  const fcmToken = await requestPermission();
  if (fcmToken) {
    // Send token to backend server to send notifications
    console.log('FCM Token:', fcmToken);
  } else {
    console.log('No FCM token received.');
  }
});

			
			
			</script>
            <footer>
                <p style="padding-top: 8px; font-size: 9px;">Developed by: Mamdouh Khalaf .. "MUE Team"</p>
            </footer>
        </div>
    </body>
</html>
